<beans:beans xsi:schemaLocation="
http://www.springframework.org/schema/security
http://www.springframework.org/schema/security/spring-security-3.2.xsd
http://www.springframework.org/schema/beans
http://www.springframework.org/schema/beans/spring-beans-4.0.xsd"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xmlns:beans="http://www.springframework.org/schema/beans"
             xmlns="http://www.springframework.org/schema/security">


    <http use-expressions="true">
        <intercept-url pattern="/index" access="isAuthenticated()"/>
        <intercept-url pattern="/" access="isAuthenticated()"/>
        <intercept-url pattern="/api/agent/notes/**" access="isAuthenticated()"/>
        <intercept-url pattern="/api/stat/find/agents/**" access="permitAll"/>

        <intercept-url pattern="api/tags/find/**" access="permitAll"/>
        <intercept-url pattern="api/taggroup/find/**" access="permitAll"/>

        <intercept-url pattern="/admin/**" access="hasRole('ROLE_ADMIN')"/>
        <intercept-url pattern="/api/roles/**" access="hasRole('ROLE_ADMIN')"/>
        <intercept-url pattern="/api/category/nested/**" access="hasRole('ROLE_ADMIN')"/>
        <intercept-url pattern="/api/product/**" access="hasRole('ROLE_ADMIN')"/>
        <intercept-url pattern="/api/stat/" access="hasRole('ROLE_ADMIN')"/>
        <intercept-url pattern="/api/tags/" access="hasRole('ROLE_ADMIN')"/>
        <intercept-url pattern="/api/taggroup/" access="hasRole('ROLE_ADMIN')"/>



        <form-login
                login-page="/login"
                default-target-url="/index"
                authentication-failure-url="/login?error=true"
                username-parameter="user_login"
                password-parameter="password_login"/>

        <logout logout-success-url="/login"/>

        <remember-me remember-me-parameter="remember_me"/>
    </http>

    <authentication-manager alias="authenticationManager">
        <authentication-provider user-service-ref="userDetailsServiceImpl"/>
    </authentication-manager>
    <beans:bean id="userDetailsServiceImpl" class="ru.avito.services.impl.UserDetailsServiceImpl"/>

</beans:beans>